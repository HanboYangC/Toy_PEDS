/blue/guo/yangh/Toy_PEDS/sh
c0304a-s10.ufhpc
Tue Aug 20 00:45:27 EDT 2024
device:cuda
Generating data:   0%|          | 0/10000 [00:00<?, ?it/s]Generating data:  98%|█████████▊| 9764/10000 [00:00<00:00, 77006.88it/s]Generating data: 100%|██████████| 10000/10000 [00:00<00:00, 77481.75it/s]
Training and validation data loaded successfully on cuda.
Testing w=0.0
Traceback (most recent call last):
  File "/blue/guo/yangh/Toy_PEDS/search_weight.py", line 62, in <module>
    train_losses, val_losses=dm.fit(params=params,learning_rate=0.1,save_path=weight_path)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/Toy_PEDS/DiffusionModel.py", line 90, in fit
    pred = self(x_batch,params)
           ^^^^^^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/.conda/envs/PEDS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/.conda/envs/PEDS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/Toy_PEDS/DiffusionModel.py", line 46, in forward
    D_numpy = geo.get_D(params['HF_N'])
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/Toy_PEDS/Geometry_1D.py", line 45, in get_D
    grid=self.get_grid(N)
         ^^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/Toy_PEDS/Geometry_1D.py", line 37, in get_grid
    ln=int(np.floor(lp/hx))
           ^^^^^^^^^^^^^^^
  File "/blue/guo/yangh/.conda/envs/PEDS/lib/python3.12/site-packages/torch/_tensor.py", line 1083, in __array__
    return self.numpy()
           ^^^^^^^^^^^^
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
